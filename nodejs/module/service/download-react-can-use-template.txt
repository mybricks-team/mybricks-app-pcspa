import React, { useEffect, useRef, useState } from "react";
import { loadMicroApp } from "qiankun";

const pageName = "--pageName--"
const pageId = "--pageId--"

const AppContainer = (props) => {
    const container = useRef(null);
    useEffect(() => {
        const app = {
            name: pageName,
            entry: `./${pageId}.html`,
        }
        let currentApp;
        if (app && container.current) {
            currentApp = loadMicroApp(
                { ...app, container: container.current, props },
                {
                    sandbox: {
                        experimentalStyleIsolation: true
                    }
                },
                {
                    beforeLoad() {
                        return Promise.resolve();
                    },
                    afterMount() {
                        return Promise.resolve();
                    },
                }
            );
        }
        return () => {
            currentApp?.unmount();
        };
    }, []);

    return React.createElement('div', { ref: container });
};

export default AppContainer;